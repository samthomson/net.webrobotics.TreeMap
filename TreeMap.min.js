var net=net||{};net.webrobotics=net.webrobotics||{};net.webrobotics.MapElement=function(e){this.key=e;this.values=new Array;this.last=0};net.webrobotics.MapElement.prototype.getKey=function(){return this.key};net.webrobotics.MapElement.prototype.addValue=function(e){this.values[this.last]=e;this.last++};net.webrobotics.MapElement.prototype.setNext=function(e){this.next=e};net.webrobotics.MapElement.prototype.setPrev=function(e){this.prev=e};net.webrobotics.MapElement.prototype.getNext=function(){return this.next};net.webrobotics.MapElement.prototype.getPrev=function(){return this.prev};net.webrobotics.MapElement.prototype.getValues=function(){return this.values};net.webrobotics.MapElement.prototype.getLastValue=function(){return this.values[this.values.length-1]};var comparator=function(e,t){if(e<t)return-1;else return e>t?1:0};net.webrobotics.TreeMap=function(e,t){this.options=t;this.allowDuplicateKeys=t?t.allowDuplicateKeys:true||true;this.suppressDuplicateKeyAlerts=t?t.suppressDuplicateKeyAlerts:false||false;this.elements=new Array;this.comparator=e};net.webrobotics.TreeMap.prototype.containsKey=function(e){return this.get(e)!=null};net.webrobotics.TreeMap.prototype.empty=function(){this.elements.length=0};net.webrobotics.TreeMap.prototype.isEmpty=function(){return this.elements.length<=0};net.webrobotics.TreeMap.prototype.containsValue=function(e){var t=this.toAny(function(t){return e==t?true:null});return t!=null};net.webrobotics.TreeMap.prototype.toAny=function(e){var t,n;var r=this.toArray();n=r.length;for(var i=n;i--;){t=e(r[i]);if(t!=null)return t}};net.webrobotics.TreeMap.prototype.forEach=function(e){var t=this.toArray();var n,r;n=t.length;for(r=0;r<n;r++)e(t[r])};net.webrobotics.TreeMap.prototype.forEachKey=function(e){var t,n,r;n=this.elements.length;for(r=0;r<n;r++){t=this.elements[r];e(t.getKey(),t.getValues())}};net.webrobotics.TreeMap.prototype.forEachCouple=function(e){var t=this.toArray();var n,r,i,s;i=this.elements.length;for(r=i;r--;){s=t.length;for(n=s;n--;){if(n!=r)e(t[r],t[n])}}};net.webrobotics.TreeMap.prototype.forEachValuesWithKey=function(e,t){var n,r,i;n=this.get(e);if(n!=null){n=this.allowDuplicateKeys==true?n:[n];r=n.length;for(i=0;i<r;i++){t(n[i])}}};net.webrobotics.TreeMap.prototype.getFilteredSubTreeMapByValue=function(e){var t=new net.webrobotics.TreeMap(this.comparator,this.options);var n,r,i,s,o,u,a;o=this.elements.length;for(r=o;r--;){n=this.elements[r];a=n.getValues();u=a.length;for(i=0;i<u;i++){s=a[i];if(e(s)==true){t.put(n.getKey(),s)}}}return t};net.webrobotics.TreeMap.prototype.getFilteredSubTreeMapByKey=function(e){var t=new net.webrobotics.TreeMap(this.comparator,this.options);var n,r,i;i=this.elements.length;for(r=i;r--;){n=this.elements[r];if(e(n.getKey())==true){t.elements.push(n)}}return t};net.webrobotics.TreeMap.prototype.getSubTreeMap=function(e,t){var n;var r=this.positionOf(e);var i=this.positionOf(t);if(!this.elements[i]||this.comparator(this.elements[i].getKey(),t)!=0){i--}if(r<=i){n=new net.webrobotics.TreeMap(this.comparator,this.options);n.elements=this.elements.slice(r,i+1)}return n};net.webrobotics.TreeMap.prototype.size=function(e){if(e&&this.allowDuplicateKeys==true){var t=0;for(var n=0;n<this.elements.length;n++){t+=this.elements[n].getValues().length}return t}else return this.elements.length};net.webrobotics.TreeMap.prototype.last=function(){var e=this.elements[this.size()-1].getValues();if(this.allowDuplicateKeys==true)return e;else return e[0]};net.webrobotics.TreeMap.prototype.first=function(){var e=this.elements[0].getValues();return this.allowDuplicateKeys==true?e:e[0]};net.webrobotics.TreeMap.prototype.at=function(e){var t;if(this.elements[e]){t=this.elements[e].getValues();return this.allowDuplicateKeys==true?t:t[0]}return null};net.webrobotics.TreeMap.prototype.put=function(e,t){var n=new net.webrobotics.MapElement(e);var r,i;n.addValue(t);r=this.positionOf(e);i=this.elements[r];if(i!=null&&this.comparator(i.getKey(),e)==0){if(this.allowDuplicateKeys)i.addValue(t);if(!this.suppressDuplicateKeyAlerts){try{console.log("Duplicate key: "+e.toString())}catch(s){}}}else{var o=new Array;o=o.concat(this.elements.slice(0,r));o.push(n);o=o.concat(this.elements.slice(r));this.elements=o}};net.webrobotics.TreeMap.prototype.positionOf=function(e){if(this.elements.length==0)return 0;var t=this.comparator(this.elements[this.elements.length-1].getKey(),e);if(t==-1)return this.elements.length;if(t==0)return this.elements.length-1;var n=this.comparator(e,this.elements[0].getKey());if(n<1)return 0;this.positionOfTR=function(e,t,n,r){var i=r-n+1;var s=Math.floor(i/2)+n;var o=this.comparator(t[s].getKey(),e);if(o==0){return s}else{if(i==1){return o==-1?n+1:n}else{return o==-1?this.positionOfTR(e,t,s,r):this.positionOfTR(e,t,n,s-1)}}};return this.positionOfTR(e,this.elements,0,this.elements.length-1)};net.webrobotics.TreeMap.prototype.toArray=function(){var e=new Array;var t,n,r;r=this.elements.length;for(n=0;n<r;n++){t=this.elements[n];e=e.concat(t.getValues())}return e};net.webrobotics.TreeMap.prototype.toMap=function(){var e={};var t,n,r;for(n=0,r=this.elements.length;n<r;n++){t=this.elements[n];e[t.getKey()]=t.getValues()}return e};net.webrobotics.TreeMap.prototype.toString=function(){var e="";var t,n,r,i,s,o,u;i=this.elements.length;for(n=0;n<i;n++){t=this.elements[n];o="";u=t.getValues();s=u.length;for(r=0;r<s;r++){o+=u[r]+","}e+="<"+t.getKey()+","+o+">; "}return e};net.webrobotics.TreeMap.prototype.remove=function(e){var t=this.positionOf(e);if(!this.elements[t]||this.comparator(this.elements[t].getKey(),e)!=0)return false;var n=new Array;if(t>0){n=n.concat(this.elements.slice(0,t))}if(t<this.elements.length-1){n=n.concat(this.elements.slice(t+1))}this.elements=n;return true};net.webrobotics.TreeMap.prototype.removeValue=function(e){var t;t=this.getFilteredSubTreeMapByValue(function(t){if(t==e){return false}return true});this.elements=t.elements};net.webrobotics.TreeMap.prototype.get=function(e){var t=this.positionOf(e);if(!this.elements[t]||this.comparator(this.elements[t].getKey(),e)!=0)return null;return this.at(t)};net.webrobotics.TreeMap.prototype.nearest=function(e,t,n){var r;var n=n!=null?n:true;var i=this.positionOf(e);var s=this.elements[i];if(s!=null&&this.comparator(s.getKey(),e)==0){if(n!=true){i+=t?+1:-1;return this.at(i)}else{r=s.getValues();return this.allowDuplicateKeys?r:r[0]}}if(t){if(s!=null){r=s.getValues();return this.allowDuplicateKeys?r:r[0]}return null}return this.at(i-1)};net.webrobotics.TreeMap.prototype.compare=function(e,t){return this.comparator(e,t)};net.webrobotics.TreeMap.prototype.clone=function(e){var t;if(e==true){}else{t=this.elements.slice(0)}return t}
